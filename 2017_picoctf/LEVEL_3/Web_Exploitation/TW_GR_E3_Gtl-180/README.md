## TW_GR_E3_Gtl - 180

### Description

Many think the third entry in the Toaster Wars: Going Rogue series didn't live up to Explorers due to its simplified gameplay, but I liked the new plot and ensemble cast better. Anyway, [this one](http://shell2017.picoctf.com:29668/) also has a flag that I can't figure out how to get...

### Hint

  - Clearly, you can't get to the flag. But perhaps you don't need to go over to it at all?

### Write up

At Floor 5, we can see that the flag is beyond the wall.

So we have to find a way to get the flag without reaching it.

In `server/game.js` file, we can find `executeMove()` function that implements getting item.

```javascript
// item check
if(entity.items.length < entity.stats.maxItems){
  var itId = -1;
  var name = "";
  for(var i = 0; i < state.items.length; i++){
    if(state.items[i].location.r == entity.location.r && state.items[i].location.c == entity.location.c){
      itId = state.items[i].id;
      msg.outcome.push({
        type: "item/get",
        id: state.items[i].id,
        item: state.items[i].name
      });
      break;
    }
  }
}

entity.items = entity.items.concat(state.items.filter(function(it){ return it.id == itId; }));
state.items = state.items.filter(function(it){ return it.id != itId; });

```

It adds item to player by this line.

```javascript
entity.items = entity.items.concat(state.items.filter(function(it){ return it.id == itId; }));
```

The interesting thing is, it adds all items in the floor that has same id.

That is, if we get an item that has same id of  flag, we can get flag without reaching it.

In `server/config.js` we can find that flag's id is 12.

```javascript
function createFlag(location) {
	return {
		name: "Flag",
		description: "Gives you the flag.",
		location: location,
		use: 0,
		id: 12,
		sprite: "flag",
		effects: [
			{
				type: "revealFlag"
			}
		]
	};
}
```

And as playing the game, it can be found that id of items be generated serially from 0 at each floor.

Therefore, what we have to do is finding a floor that has more than 13 items, so that we can get an item that has id 12. And then, go to floor 5, drop the item with id 12, re-get it.

> the_new_feature_where_you_manage_your_own_shelf_in_the_refrigerator_was_an_interesting_addition_6aaa8ea8b1ab25329c8eced6bbc8a0be
