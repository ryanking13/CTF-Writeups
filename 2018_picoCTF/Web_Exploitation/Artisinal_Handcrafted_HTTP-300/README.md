## Artisinal Handcrafted HTTP - 300

### Description

> We found a hidden flag server hiding behind a proxy, but the proxy has some... _interesting_ ideas of what qualifies someone to make HTTP requests. Looks like you'll have to do this one by hand. Try connecting via nc 2018shell1.picoctf.com 17643, and use the proxy to send HTTP requests to `flag.local`. We've also recovered a username and a password for you to use on the login page: `realbusinessuser`/`potoooooooo`.

### Write up

We need to handcraft HTTP request.

```
GET / HTTP/1.1
User-Agent: curl/7.35.0
Host: flag.local
Accept: */*
```

Sending this returns,

```
<html>
        <head>
                <link rel="stylesheet" type="text/css" href="main.css" />
        </head>
        <body>
                <header>
                        <h1>Real Business Internal Flag Server</h1>
                        <a href="/login">Login</a>
                </header>
                <main>
                        <p>You need to log in before you can see today's flag.</p>
                </main>
        </body>
</html>
```

So, we need to login.

```
GET /login HTTP/1.1
User-Agent: curl/7.35.0
Host: flag.local
Accept: */*
```

Sending this returns,

```
<form method="POST" action="login">
        <input type="text" name="user" placeholder="Username" />
        <input type="password" name="pass" placeholder="Password" />
        <input type="submit" />
</form>
```

Now we know the parameter names.

```
POST /login HTTP/1.1
User-Agent: curl/7.35.0
Host: flag.local
Accept: */*
Content-Length: 38
Content-Type: application/x-www-form-urlencoded

user=realbusinessuser&pass=potoooooooo
```

Sending this returns,

```
HTTP/1.1 302 Found
x-powered-by: Express
set-cookie: real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D; Path=/
location: /
vary: Accept
content-type: text/plain; charset=utf-8
content-length: 23
date: Sat, 29 Sep 2018 08:10:43 GMT
connection: close
```

Now we got the cookie.

```
GET / HTTP/1.1
User-Agent: curl/7.35.0
Host: flag.local
Accept: */*
Cookie: real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D; Path=/
```

now by sending cookie, flag is obtained.
